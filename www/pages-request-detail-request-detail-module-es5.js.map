{"version":3,"sources":["webpack:///src/app/pages/request-detail/request-detail.page.html","webpack:///src/app/pages/request-detail/request-detail.page.ts","webpack:///src/app/pages/request-detail/request-detail.module.ts"],"names":["RequestDetailPage","camera","actionSheetController","translate","platform","loading","apiService","navCtrl","route","editorMsg","showEmojiPicker","listImage","detailRequest","isExpand","blobToFile","theBlob","fileName","b","lastModifiedDate","Date","name","self","ready","then","readySource","widthListScreen","width","heightScreen","height","defineHeightScreen","requestDetailComponentShare","list_image_select","requestTitle","requestContent","currentUser","JSON","parse","localStorage","getItem","requestID","snapshot","paramMap","get","getArticleDetail","present","getRequestNewDetail","subscribe","result","feedbacknew","title","content","createdAt","createBy","createdBy","displayName","feedbackID","_id","attachments","length","getListMessage","error","dismiss","isRefresh","getListFeedbackNewReply","msgList","feedbacknewReplies","slice","reverse","scrollToBottom","focus","stringDate","formatString","formatStringFull","event","back","animated","animationDirection","resize","setTextareaScroll","setTimeout","messageInput","nativeElement","getBoundingClientRect","top","contentRequest","bottom","trim","id","now","toString","newMsg","messageId","avatar","toISOString","pushNewMsg","params","addFeedbackNewReply","index","getMsgIndexById","status","listAttachments","i","push","media","msg","findIndex","e","textarea","scrollTop","scrollHeight","string","substring","create","header","instant","buttons","text","handler","checkPicturePermission","PictureSourceType","PHOTOLIBRARY","CAMERA","role","actionSheet","sourceType","pickImage","options","quality","destinationType","DestinationType","DATA_URL","encodingType","EncodingType","JPEG","mediaType","MediaType","PICTURE","targetWidth","targetHeight","correctOrientation","getPicture","imageData","base64Define","binaryBlob","convertBase64ToBlob","date","valueOf","formData","FormData","myFile","payload","append","uploadImage","sendAttachmentImage","err","base64","info","getInfoFromBase64","sliceSize","byteCharacters","window","atob","rawBase64","byteArrays","offset","byteNumbers","Array","charCodeAt","Uint8Array","Blob","type","mime","meta","split","replace","exec","extension","selectImage","sendMsg","selector","templateUrl","styleUrls","routes","path","component","RequestDetailPageModule","forChild","imports","declarations"],"mappings":"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","file":"pages-request-detail-request-detail-module-es5.js","sourcesContent":["<ion-header class=\"ion-no-border request-header-detail\">\r\n  <ion-buttons class=\"back-button\">\r\n    <ion-back-button color=\"light\" text=\"\" icon=\"chevron-back\" class=\"ion-back-button\"></ion-back-button>\r\n  </ion-buttons>\r\n</ion-header>\r\n<ion-card class=\"request-card\">\r\n  <ion-item lines=\"none\" class=\"request-card-item\">\r\n    <ion-label slot=\"start\" class=\"update-time\">{{formatString(detailRequest.updatedAt)}}</ion-label>\r\n    <ion-badge slot=\"end\" class=\"badge-status badge-danger\" *ngIf=\"detailRequest.status == 'new'\">{{\r\n      'REQUEST.status_new' | translate }}</ion-badge>\r\n    <ion-badge slot=\"end\" class=\"badge-status badge-warning\" *ngIf=\"detailRequest.status == 'processing'\">{{\r\n      'REQUEST.status_processing' | translate }}</ion-badge>\r\n    <ion-badge slot=\"end\" class=\"badge-status badge-success\" *ngIf=\"detailRequest.status == 'completed'\">{{\r\n      'REQUEST.status_done' | translate }}</ion-badge>\r\n    <ion-badge slot=\"end\" class=\"badge-status badge-cancel\" *ngIf=\"detailRequest.status == 'cancelled'\">{{\r\n      'REQUEST.status_cancelled' | translate }}</ion-badge>\r\n  </ion-item>\r\n  <ion-text class=\"\">\r\n    <p class=\"request-title\">{{detailRequest.title}}</p>\r\n  </ion-text>\r\n  <div class=\"devider-line-custom margin-top-10\"></div>\r\n  <div class=\"detail-content-block\" *ngIf=\"isExpand\">\r\n    <ion-item lines=\"none\" class=\"ion-item-block\">\r\n      <ion-icon class=\"ion-icon\" src=\"../assets/icon/request/home.svg\"></ion-icon>\r\n      <ion-label class=\"ion-item-lable\">{{detailRequest.apartment?.title + ' - ' + detailRequest.campaign?.title}}</ion-label>\r\n    </ion-item>\r\n    <ion-item lines=\"none\" class=\"ion-item-block\" *ngIf=\"detailRequest.category?.title\">\r\n      <ion-icon class=\"ion-icon\" src=\"../assets/icon/request/danger.svg\"></ion-icon>\r\n      <ion-label class=\"ion-item-lable\">{{detailRequest.category?.title}}</ion-label>\r\n    </ion-item>\r\n    <div class=\"ion-text\">{{detailRequest.content}}</div>\r\n  </div>\r\n\r\n  <div class=\"button-expand\" (click)=\"isExpand = !isExpand\">\r\n    <ion-label class=\"expand-label\">{{ (!isExpand ? 'REQUEST_DETAIL.display_info': 'REQUEST_DETAIL.collapse') | translate}}</ion-label>\r\n    <img [src]=\"!isExpand ? '../assets/icon/svg/Down.svg' : '../assets/icon/svg/up.svg'\" />\r\n  </div>\r\n</ion-card>\r\n\r\n<ion-content class=\"request-detail-content\">\r\n  <!-- <ion-card class=\"card-content\">\r\n    <ion-grid class=\"image-grid\">\r\n      <ion-row class=\"image-row\">\r\n        <ion-col class=\"image-col\" size=\"12\" *ngIf=\"listImage.length == 1\">\r\n          <img class=\"image-col-1 image-col-left\" src=\"{{listImage[0].url}}\" />\r\n        </ion-col>\r\n        <ion-col class=\"image-col\" size=\"6\" *ngIf=\"listImage.length == 2\">\r\n          <img class=\"image-col-1 image-col-left\" src=\"{{listImage[0].url}}\" />\r\n        </ion-col>\r\n        <ion-col class=\"image-col\" size=\"6\" *ngIf=\"listImage.length == 2\">\r\n          <img class=\"image-col-1 image-col-left\" src=\"{{listImage[1].url}}\" />\r\n        </ion-col>\r\n        <ion-col class=\"image-col\" size=\"8\" *ngIf=\"listImage.length > 2\">\r\n          <img class=\"image-col-1 image-col-left\" src=\"{{listImage[0].url}}\" />\r\n        </ion-col>\r\n        <ion-col class=\"image-col\" size=\"4\" *ngIf=\"listImage.length > 2\">\r\n          <img class=\"image-col-2 image-col-right-top\" src=\"{{listImage[1].url}}\" />\r\n          <div class=\"image-container\">\r\n            <img class=\"image-col-2 image-col-right-top\" src=\"{{listImage[2].url}}\" *ngIf=\"listImage.length == 3\"/>\r\n            <img class=\"image-col-2 image-col-right-bottom\" src=\"{{listImage[2].url}}\" *ngIf=\"listImage.length > 3\"/>\r\n            <ion-label class=\"centered\" *ngIf=\"listImage.length > 3\">+{{listImage.length - 3}}</ion-label>\r\n          </div>          \r\n        </ion-col>\r\n      </ion-row>      \r\n    </ion-grid>\r\n    <ion-card-content class=\"box\">\r\n      <input type=\"checkbox\" id=\"expanded\">\r\n      <p [innerHTML]=\"requestContent\" #contentRequest class=\"text-content\"></p>\r\n      <label *ngIf=\"requestContent.length > 200\" for=\"expanded\" role=\"button\">{{ 'REQUEST_DETAIL.read_more' | translate }}</label>\r\n    </ion-card-content>\r\n  </ion-card>  \r\n  <div class=\"devider-line\"></div>\r\n -->\r\n  <ion-content #content class=\"list-chat-content\">\r\n    <div class=\"message-wrap\">\r\n      <div *ngFor=\"let msg of msgList\" class=\"message\" [class.left]=\" msg.createdBy && msg.createdBy._id !== currentUser._id \"\r\n        [class.right]=\" msg.createdBy && msg.createdBy._id === currentUser._id \">\r\n        <img *ngIf=\"msg.createdBy\" class=\"user-img\" [src]=\"msg.createdBy.avatar\" alt=\"\" />\r\n        <div class=\"msg-detail\" *ngIf=\"msg.createdBy\">\r\n          <div class=\"msg-info\">\r\n            <p>{{msg.createdBy.displayName}}</p>\r\n          </div>\r\n          <div class=\"msg-content\" *ngIf=\"!msg.attachments || msg.attachments.length == 0\">\r\n            <p class=\"line-breaker\">{{msg.content}}</p>\r\n          </div>\r\n          <div class=\"msg-content msg-images\" *ngIf=\"msg.attachments && msg.attachments.length > 0\">\r\n            <img *ngFor=\"let attachments of msg.attachments\" class=\"\" src=\"{{attachments.url}}\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </ion-content>\r\n</ion-content>\r\n<ion-footer class=\"ion-no-border\">\r\n  <ion-item lines=\"none\" class=\"add-comment-item\">\r\n    <ion-icon [src]=\"'../assets/icon/request/camera.svg'\" slot=\"start\" class=\"add-image-icon\" (click)=\"selectImage()\"></ion-icon>\r\n    <ion-textarea class=\"input-area\" rows=\"1\" auto-grow (ionFocus)=\"isExpand = false\" placeholder=\"{{ 'REQUEST_DETAIL.place_holder_input' | translate }}\"\r\n      [(ngModel)]=\"editorMsg\">\r\n      <ion-icon [src]=\"editorMsg?.length > 0 ? '../assets/icon/request/send.svg' : '../assets/icon/request/send-gray.svg'\"\r\n        class=\"icon-send icon-send-default\" (click)=\"sendMsg()\"></ion-icon>\r\n    </ion-textarea>\r\n  </ion-item>\r\n</ion-footer>","import { Component, OnInit, OnDestroy, ViewChild, AfterViewInit, Input, ElementRef } from '@angular/core';\r\nimport { ApiService } from '../../services/api/api.service';\r\nimport { ActionSheetController, NavController, NavParams, Platform } from '@ionic/angular';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { LoadingService } from '../../services/loading/loading.service';\r\nimport { ConstService } from '../../utils/const.service';\r\nimport { UtilsService } from '../../utils/utils.service';\r\nimport { Camera, CameraOptions, PictureSourceType } from '@ionic-native/Camera/ngx';\r\nimport { TranslateService } from '@ngx-translate/core';\r\n\r\n@Component({\r\n  selector: 'app-request-detail',\r\n  templateUrl: './request-detail.page.html',\r\n  styleUrls: ['./request-detail.page.scss'],\r\n})\r\nexport class RequestDetailPage implements OnInit, AfterViewInit {\r\n  \r\n  @ViewChild('contentRequest') contentRequest: any;\r\n  @ViewChild('content') content: any;\r\n  @ViewChild('chat_input') messageInput: any;\r\n\r\n  requestTitle: string;\r\n  requestContent: string;\r\n  thumbnail: string;\r\n  createdAt: string;\r\n  createBy: string;\r\n  editorMsg = '';\r\n  msgList:any;\r\n  showEmojiPicker = false;\r\n  currentUser: any;\r\n  feedbackID:string;\r\n  defineHeightScreen:number;\r\n  heightScreen:number;\r\n  listImage: any[] = [];\r\n  widthListScreen:number;\r\n  showMore : false;\r\n  list_image_select: any;\r\n  detailRequest: any = {};\r\n  isExpand = false;\r\n\r\n  constructor(\r\n    private camera: Camera,\r\n    public actionSheetController: ActionSheetController,\r\n    private translate: TranslateService,\r\n    private platform: Platform,\r\n    private loading: LoadingService,\r\n    private apiService: ApiService,\r\n    private navCtrl: NavController,\r\n    private route: ActivatedRoute) { \r\n      var self = this;\r\n      platform.ready().then((readySource) => {\r\n        self.widthListScreen = platform.width() * 0.8;\r\n        self.heightScreen = platform.height() * 0.80;\r\n        self.defineHeightScreen = this.heightScreen;\r\n      });\r\n      UtilsService.requestDetailComponentShare = this;\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.list_image_select = [];\r\n    this.requestTitle = \"\";\r\n    this.requestContent = \"\";\r\n    this.currentUser = JSON.parse(localStorage.getItem('profile'));\r\n\r\n  }\r\n\r\n  ngAfterViewInit(){\r\n    const requestID = this.route.snapshot.paramMap.get('id');\r\n    this.getArticleDetail(requestID);\r\n  }\r\n\r\n  getArticleDetail(requestID) {\r\n    this.loading.present();\r\n    const self = this;\r\n    this.apiService.getRequestNewDetail(requestID)\r\n      .subscribe(result => {\r\n        this.detailRequest = result.feedbacknew;\r\n        self.requestTitle = result.feedbacknew.title;\r\n        self.requestContent = result.feedbacknew.content;\r\n        self.createdAt = result.feedbacknew.createdAt;\r\n        self.createBy = result.feedbacknew.createdBy != null ? result.feedbacknew.createdBy.displayName : \"\";\r\n        self.feedbackID = result.feedbacknew._id;\r\n        self.listImage = result.feedbacknew.attachments;\r\n        if(self.listImage.length > 0){\r\n          this.heightScreen = self.defineHeightScreen - 100;\r\n        }\r\n        // self.updateSizeContent();\r\n        self.getListMessage(self.feedbackID);\r\n    },\r\n    error => {\r\n      self.loading.dismiss();\r\n    });\r\n  }\r\n\r\n  getListMessage(feedbackID, isRefresh= false){\r\n    const self = this;\r\n    this.apiService.getListFeedbackNewReply(feedbackID)\r\n    .subscribe(result => {\r\n      self.msgList = result.feedbacknewReplies.slice().reverse();\r\n      self.scrollToBottom();\r\n      if(isRefresh){\r\n        self.focus();\r\n      }\r\n      self.loading.dismiss();\r\n    },\r\n    error => {\r\n      self.loading.dismiss();\r\n    });\r\n  }\r\n\r\n  formatString(stringDate: string) {\r\n    return UtilsService.formatString(stringDate);\r\n  }\r\n  \r\n  formatStringFull(stringDate: string) {\r\n    return UtilsService.formatStringFull(stringDate);\r\n  }\r\n\r\n  backScreen(event){\r\n    this.navCtrl.back({\r\n      animated: true,\r\n      animationDirection: 'back'\r\n    })\r\n  }\r\n\r\n  onFocus() {\r\n    this.showEmojiPicker = false;\r\n    this.content.resize();\r\n    this.scrollToBottom();\r\n  }\r\n\r\n  switchEmojiPicker() {\r\n    this.showEmojiPicker = !this.showEmojiPicker;\r\n    if (!this.showEmojiPicker) {\r\n      this.focus();\r\n    } else {\r\n      this.setTextareaScroll();\r\n    }\r\n    this.content.resize();\r\n    this.scrollToBottom();\r\n  }\r\n\r\n  updateSizeContent(){\r\n    var self = this;\r\n    setTimeout(() => {\r\n      self.heightScreen = self.messageInput.nativeElement.getBoundingClientRect().top - self.contentRequest.nativeElement.getBoundingClientRect().bottom - 2;\r\n    }, 400);\r\n  }\r\n\r\n  sendMsg() {\r\n    if (!this.editorMsg.trim()) return;\r\n    var self = this;\r\n    // Mock message\r\n    const id = Date.now().toString();\r\n    let newMsg = {\r\n      messageId: id,\r\n      createdBy:{\r\n        displayName : this.currentUser.displayName,\r\n        _id: this.currentUser._id,\r\n        avatar: this.currentUser.avatar == \"\" ? '../assets/icon/avatar-default.png' : this.currentUser.avatar\r\n      },\r\n      createdAt: new Date().toISOString(),\r\n      content: this.editorMsg,\r\n    };\r\n\r\n    this.pushNewMsg(newMsg);\r\n    this.editorMsg = '';\r\n\r\n    if (!this.showEmojiPicker) {\r\n      this.focus();\r\n    }\r\n    const params = {\r\n      content: newMsg.content\r\n    };\r\n\r\n    this.apiService.addFeedbackNewReply(self.feedbackID, params)\r\n    .subscribe(result => {\r\n      let index = this.getMsgIndexById(id);\r\n        if (index !== -1) {\r\n          self.msgList[index].status = 'success';\r\n        }\r\n    },\r\n    error => {\r\n      self.loading.dismiss();\r\n    });\r\n  }\r\n\r\n  sendAttachmentImage() {\r\n    if (this.list_image_select.length == 0) return;\r\n    var self = this;\r\n    // // Mock message\r\n    const id = Date.now().toString();\r\n    let listAttachments = [];\r\n    for(var i=0;i<self.list_image_select.length;i++){\r\n      listAttachments.push(self.list_image_select[i].media);\r\n    }\r\n    let newMsg = {\r\n      messageId: id,\r\n      createdBy:{\r\n        displayName : this.currentUser.displayName,\r\n        _id: this.currentUser._id,\r\n        avatar: this.currentUser.avatar == \"\" ? '../assets/icon/avatar-default.png' : this.currentUser.avatar\r\n      },\r\n      createdAt: new Date().toISOString(),\r\n      content: \" \",\r\n      attachments: listAttachments\r\n    };\r\n\r\n    this.pushNewMsg(newMsg);\r\n    this.editorMsg = '';\r\n\r\n    if (!this.showEmojiPicker) {\r\n      this.focus();\r\n    }\r\n    const params = {\r\n      content: \" \",\r\n      attachments: listAttachments\r\n    };\r\n\r\n    this.apiService.addFeedbackNewReply(self.feedbackID, params)\r\n    .subscribe(result => {\r\n      self.list_image_select = [];\r\n      let index = this.getMsgIndexById(id);\r\n      if (index !== -1) {\r\n        self.msgList[index].status = 'success';\r\n      }\r\n    },\r\n    error => {\r\n      self.loading.dismiss();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @name pushNewMsg\r\n   * @param msg\r\n   */\r\n  pushNewMsg(msg: any) {\r\n    this.msgList.push(msg);\r\n    this.scrollToBottom();\r\n  }\r\n\r\n  getMsgIndexById(id: string) {\r\n    return this.msgList.findIndex(e => e.messageId === id)\r\n  }\r\n\r\n  scrollToBottom() {\r\n    var self = this;\r\n    setTimeout(() => {\r\n      if (self.content.scrollToBottom) {\r\n        self.content.scrollToBottom();\r\n      }\r\n    }, 400)\r\n  }\r\n\r\n  private focus() {\r\n    if (this.messageInput && this.messageInput.nativeElement) {\r\n      this.messageInput.nativeElement.focus();\r\n    }\r\n  }\r\n\r\n  private setTextareaScroll() {\r\n    const textarea = this.messageInput.nativeElement;\r\n    textarea.scrollTop = textarea.scrollHeight;\r\n  }\r\n\r\n  trimString(string, length) {\r\n    return string.length > length\r\n      ? string.substring(0, length) + \"...\"\r\n      : string;\r\n  }\r\n\r\n\r\n\r\n  // select image\r\n  async selectImage() {\r\n    const actionSheet = await this.actionSheetController.create({\r\n      header: this.translate.instant('COMMON.form_select_image_title'),\r\n      buttons: [{\r\n        text: this.translate.instant('COMMON.form_select_image_library'),\r\n        handler: () => {\r\n          this.checkPicturePermission(this.camera.PictureSourceType.PHOTOLIBRARY);\r\n        }\r\n      },\r\n      {\r\n        text: this.translate.instant('COMMON.form_select_image_camera'),\r\n        handler: () => {\r\n          this.checkPicturePermission(this.camera.PictureSourceType.CAMERA);\r\n        }\r\n      },\r\n      {\r\n        text: this.translate.instant('COMMON.form_select_image_cancel'),\r\n        role: 'cancel'\r\n      }\r\n      ]\r\n    });\r\n    await actionSheet.present();\r\n  }\r\n\r\n  checkPicturePermission(sourceType : PictureSourceType) {\r\n    this.pickImage(sourceType);\r\n  }\r\n\r\n  blobToFile = (theBlob: Blob, fileName:string): any => {\r\n    var b: any = theBlob;\r\n    //A Blob() is almost a File() - it's just missing the two properties below which we will add\r\n    b.lastModifiedDate = new Date();\r\n    b.name = fileName;\r\n\r\n    //Cast to a File() type\r\n    return theBlob;\r\n  }\r\n\r\n  pickImage(sourceType) {\r\n    var self = this;\r\n    const options: CameraOptions = {\r\n      quality: 80,\r\n      sourceType: sourceType,\r\n      destinationType: this.camera.DestinationType.DATA_URL,\r\n      encodingType: this.camera.EncodingType.JPEG,\r\n      mediaType: this.camera.MediaType.PICTURE,\r\n      targetWidth: 800,\r\n      targetHeight: 800,\r\n      correctOrientation: true,\r\n    }\r\n    \r\n    this.camera.getPicture(options).then((imageData) => {\r\n    \r\n      const base64Define = 'data:image/jpeg;base64,';\r\n      var binaryBlob = this.convertBase64ToBlob(base64Define+imageData);\r\n      const date = new Date().valueOf();\r\n      const formData = new FormData();\r\n      var fileName = \"amoapp\" + date + \".jpg\";\r\n      var myFile = self.blobToFile(binaryBlob, fileName);\r\n      const payload = new FormData();\r\n      payload.append('media', binaryBlob, fileName);\r\n\r\n      this.apiService.uploadImage(payload)\r\n      .subscribe(result => {\r\n        self.list_image_select = [];\r\n        self.list_image_select.push(result);\r\n        self.sendAttachmentImage();\r\n      },\r\n        error => {\r\n      });\r\n    }, (err) => {\r\n      // Handle error\r\n      // alert(err);\r\n    });\r\n  }\r\n\r\n  private convertBase64ToBlob(base64: string) {\r\n    const info = this.getInfoFromBase64(base64);\r\n    const sliceSize = 512;\r\n    const byteCharacters = window.atob(info.rawBase64);\r\n    const byteArrays = [];\r\n\r\n    for (let offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n      const slice = byteCharacters.slice(offset, offset + sliceSize);\r\n      const byteNumbers = new Array(slice.length);\r\n\r\n      for (let i = 0; i < slice.length; i++) {\r\n        byteNumbers[i] = slice.charCodeAt(i);\r\n      }\r\n\r\n      byteArrays.push(new Uint8Array(byteNumbers));\r\n    }\r\n\r\n    return new Blob(byteArrays, { type: info.mime });\r\n  }\r\n\r\n  private getInfoFromBase64(base64: string) {\r\n    const meta = base64.split(',')[0];\r\n    const rawBase64 = base64.split(',')[1].replace(/\\s/g, '');\r\n    const mime = /:([^;]+);/.exec(meta)[1];\r\n    const extension = /\\/([^;]+);/.exec(meta)[1];\r\n\r\n    return {\r\n      mime,\r\n      extension,\r\n      meta,\r\n      rawBase64\r\n    };\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { RequestDetailPage } from './request-detail.page';\r\nimport { TranslateModule, TranslateLoader } from '@ngx-translate/core';\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: RequestDetailPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    TranslateModule,\r\n    RouterModule.forChild(routes)\r\n  ],\r\n  declarations: [RequestDetailPage]\r\n})\r\nexport class RequestDetailPageModule {}\r\n"]}