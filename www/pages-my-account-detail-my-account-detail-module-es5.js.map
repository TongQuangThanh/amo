{"version":3,"sources":["webpack:///src/app/pages/my-account-detail/my-account-detail-routing.module.ts","webpack:///src/app/pages/my-account-detail/my-account-detail.module.ts","webpack:///src/app/pages/my-account-detail/my-account-detail.page.html","webpack:///src/app/pages/my-account-detail/my-account-detail.page.ts"],"names":["routes","path","component","MyAccountDetailPageRoutingModule","forChild","imports","exports","MyAccountDetailPageModule","declarations","MyAccountDetailPage","loading","apiService","navCtrl","translate","translateConfigService","alertService","camera","actionSheetController","formPhoneCode","list_image_select","isChangeAvatar","selectedLanguage","getDefaultLanguage","getUserProfile","listCountry","LIST_COUNTRIES","countryAlpha2","avatarCountry","self","present","subscribe","result","displayName","profile","email","phone","gender","nationality","dateOfBirth","personalLiscence","avatar","dismiss","error","navigateForward","params","updateUserProfile","localStorage","setItem","JSON","stringify","updateAvatar","presentToast","instant","postUpdateAvatar","forEach","country","alpha2","phoneCode","toLowerCase","create","header","buttons","text","handler","checkPicturePermission","PictureSourceType","PHOTOLIBRARY","CAMERA","role","actionSheet","sourceType","pickImage","options","quality","destinationType","DestinationType","DATA_URL","encodingType","EncodingType","PNG","mediaType","MediaType","PICTURE","targetWidth","targetHeight","getPicture","then","imageData","base64","date","Date","valueOf","imageName","binaryBlob","convertBase64ToBlob","payload","FormData","append","uploadImage","media","url","err","info","getInfoFromBase64","sliceSize","byteCharacters","window","atob","rawBase64","byteArrays","offset","length","slice","byteNumbers","Array","i","charCodeAt","push","Uint8Array","Blob","type","mime","meta","split","replace","exec","extension","selectImage","onChangeCountry","updateAccount","selector","templateUrl","styleUrls"],"mappings":"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","file":"pages-my-account-detail-my-account-detail-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { TranslateModule, TranslateLoader } from '@ngx-translate/core';\r\n\r\nimport { MyAccountDetailPage } from './my-account-detail.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: MyAccountDetailPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    TranslateModule,\r\n    RouterModule.forChild(routes)\r\n  ],\r\n  exports: [RouterModule],\r\n})\r\nexport class MyAccountDetailPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { TranslateModule, TranslateLoader } from '@ngx-translate/core';\r\n\r\nimport { MyAccountDetailPageRoutingModule } from './my-account-detail-routing.module';\r\nimport { MyAccountDetailPage } from './my-account-detail.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    TranslateModule,\r\n    MyAccountDetailPageRoutingModule\r\n  ],\r\n  declarations: [MyAccountDetailPage]\r\n})\r\nexport class MyAccountDetailPageModule {}\r\n","<ion-header class=\"ion-no-border account-detail-header\">\r\n  <ion-buttons class=\"back-button\">\r\n    <ion-back-button color=\"light\" text=\"\" icon=\"chevron-back\" class=\"ion-back-button\"></ion-back-button>\r\n  </ion-buttons>\r\n  <ion-label class=\"header-title\">{{ 'MY_ACCOUNT_DETAIL.title' | translate }}</ion-label>\r\n</ion-header>\r\n<div class=\"my-account-avatar\">\r\n  <ion-avatar class=\"account-avatar\" (click)=\"selectImage()\">\r\n    <img src=\"{{avatar}}\" />\r\n  </ion-avatar>\r\n  <ion-icon class=\"icon-camera\" name=\"camera\"></ion-icon>\r\n</div>\r\n\r\n<ion-content class=\"account-detail-content\">\r\n  <ion-item class=\"input-item\" lines=\"none\">\r\n    <ion-icon class=\"input-icon\" name=\"custom-user\" src=\"/assets/icon/account/user.svg\" slot=\"start\"></ion-icon>\r\n    <ion-label class=\"input-floating-label\" position=\"floating\">{{ 'MY_ACCOUNT_DETAIL.name' | translate }}</ion-label>\r\n    <ion-input class=\"input-text\" type=\"text\" name=\"userName\" [(ngModel)]=\"displayName\"></ion-input>\r\n  </ion-item>\r\n  <ion-item class=\"input-item\" lines=\"none\">\r\n    <ion-icon class=\"input-icon\" name=\"custom-mail\" src=\"/assets/icon/account/user-mail.svg\" slot=\"start\"></ion-icon>\r\n    <ion-label class=\"input-floating-label\" position=\"floating\">{{ 'MY_ACCOUNT_DETAIL.email' | translate }}</ion-label>\r\n    <ion-input class=\"input-text\" type=\"text\" name=\"userEmail\" [(ngModel)]=\"email\"></ion-input>\r\n  </ion-item>\r\n\r\n  <ion-row>\r\n    <ion-col class=\"no-padding padding-right-10\" size=\"5\">\r\n      <ion-item class=\"input-item\" lines=\"none\">\r\n        <ion-icon class=\"input-icon\" name=\"flag-vn\" src=\"{{avatarCountry}}\" slot=\"start\"></ion-icon>\r\n        <ion-label class=\"label-phone-code\">+{{formPhoneCode}}</ion-label>\r\n        <ion-select (ionChange)=\"onChangeCountry()\" class=\"input-text select-text opacity-0\" value=\"male\" [(ngModel)]=\"countryAlpha2\">\r\n          <ion-select-option *ngFor=\"let object of listCountry\" value=\"{{object.alpha2}}\">{{object.name}}</ion-select-option>\r\n        </ion-select>\r\n      </ion-item>\r\n    </ion-col>\r\n    <ion-col class=\"no-padding padding-left-10\">\r\n      <ion-item lines=\"none\" class=\"input-item\">\r\n        <ion-input class=\"input-text no-floating-label\" type=\"number\"  [(ngModel)]=\"phone\"></ion-input>\r\n      </ion-item>\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col class=\"no-padding padding-right-10\" size=\"6\">\r\n      <ion-item class=\"input-item\" lines=\"none\">\r\n        <ion-icon class=\"input-icon\" name=\"custom-gift\" src=\"/assets/icon/account/birthday.svg\" slot=\"start\"></ion-icon>\r\n        <ion-label class=\"input-floating-label\" position=\"floating\">{{ 'MY_ACCOUNT_DETAIL.DOB' | translate }}</ion-label>\r\n        <ion-datetime class=\"input-text input-text-50\" [(ngModel)]=\"dateOfBirth\" displayFormat=\"DD/MM/YYYY\"></ion-datetime>\r\n      </ion-item>\r\n    </ion-col>\r\n    <ion-col class=\"no-padding padding-left-10\" size=\"6\">\r\n      <ion-item class=\"input-item\" lines=\"none\">\r\n        <ion-icon class=\"input-icon\" name=\"custom-gift\" src=\"/assets/icon/account/gender.svg\" slot=\"start\"></ion-icon>\r\n        <ion-label class=\"input-floating-label\" position=\"floating\">{{ 'MY_ACCOUNT_DETAIL.gender' | translate }}</ion-label>\r\n        <ion-select class=\"input-text select-text\" [(ngModel)]=\"gender\">\r\n          <ion-select-option value=\"female\">{{ 'MY_ACCOUNT_DETAIL.female' | translate }}</ion-select-option>\r\n          <ion-select-option value=\"male\">{{ 'MY_ACCOUNT_DETAIL.male' | translate }}</ion-select-option>\r\n        </ion-select>\r\n      </ion-item>\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-button expand=\"block\" class=\"button-common button-send btn-active\" (click)=\"updateAccount()\">\r\n    <ion-label>{{ 'MY_ACCOUNT_DETAIL.btn_save' | translate }}</ion-label>\r\n  </ion-button>\r\n</ion-content>","import { Component, OnInit } from '@angular/core';\r\nimport { ApiService } from '../../services/api/api.service';\r\nimport { LoadingService } from '../../services/loading/loading.service';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { TranslateConfigService } from '../../translate-config.service';\r\nimport { ActionSheetController, NavController } from '@ionic/angular';\r\nimport { AlertService } from 'src/app/services/alert/alert.service';\r\nimport { ConstService } from '../../utils/const.service';\r\nimport { Camera, CameraOptions, PictureSourceType } from '@ionic-native/Camera/ngx';\r\n\r\n@Component({\r\n  selector: 'app-my-account-detail',\r\n  templateUrl: './my-account-detail.page.html',\r\n  styleUrls: ['./my-account-detail.page.scss'],\r\n})\r\nexport class MyAccountDetailPage implements OnInit {\r\n  selectedLanguage:string;\r\n  avatar:any;\r\n  displayName: string;\r\n  email: string;\r\n  timeOrder: any;\r\n  gender:any;\r\n  nationality: any;\r\n  dateOfBirth: any;\r\n  personalLiscence: any;\r\n  // listCountries:any;\r\n  userName: string;\r\n  phone: string;\r\n  male: string;\r\n  female: string;\r\n  listCountry: any;\r\n  avatarCountry: any;\r\n  countryAlpha2: any;\r\n  formPhoneCode: any = 84;\r\n  list_image_select: any[] = [];\r\n  isChangeAvatar: boolean = false;\r\n\r\n  constructor(\r\n    private loading: LoadingService,\r\n    private apiService: ApiService,\r\n    private navCtrl: NavController,\r\n    private translate: TranslateService,\r\n    private translateConfigService: TranslateConfigService,\r\n    private alertService: AlertService,\r\n    private camera: Camera,\r\n    public actionSheetController: ActionSheetController,\r\n  ) { \r\n    this.selectedLanguage = this.translateConfigService.getDefaultLanguage();\r\n  }\r\n  \r\n  ngOnInit() {\r\n    this.getUserProfile();\r\n    this.listCountry = ConstService.LIST_COUNTRIES;\r\n    this.countryAlpha2 = \"vn\";\r\n    this.avatarCountry = \"https://lipis.github.io/flag-icon-css/flags/4x3/vn.svg\";\r\n  }\r\n\r\n  getUserProfile(){\r\n    var self = this;\r\n    this.loading.present();\r\n    this.apiService.getUserProfile()\r\n      .subscribe(result => {\r\n        self.displayName = result.profile.displayName;\r\n        self.email = result.profile.email;\r\n        self.phone = result.profile.phone;\r\n        self.gender = result.profile.gender;\r\n        self.nationality = result.profile.nationality;\r\n        self.dateOfBirth = result.profile.dateOfBirth;\r\n        self.personalLiscence = result.profile.personalLiscence;\r\n        self.avatar = result.profile.avatar != null ? result.profile.avatar : '../assets/icon/avatar-default.png';\r\n        self.loading.dismiss();\r\n    },\r\n    error => {\r\n      self.loading.dismiss();\r\n    });\r\n  }\r\n\r\n  addHomeMember(){\r\n    this.navCtrl.navigateForward('/add-home-member');\r\n  }\r\n\r\n  updateAccount(){\r\n    var self = this;\r\n    const params = {\r\n      email: self.email,\r\n      displayName: self.displayName,\r\n      phone: self.phone,\r\n      gender: self.gender,\r\n      dateOfBirth: self.dateOfBirth,\r\n      personalLiscence: self.personalLiscence\r\n    };\r\n    this.loading.present();\r\n    this.apiService.updateUserProfile(params)\r\n      .subscribe(result => {\r\n        localStorage.setItem('profile', JSON.stringify(result.profile));\r\n        if (self.isChangeAvatar) {\r\n          self.updateAvatar();\r\n        } else {\r\n          self.loading.dismiss()\r\n          self.alertService.presentToast(this.translate.instant('MY_ACCOUNT.message_update_sucess'));\r\n        }\r\n    },\r\n    error => {\r\n      self.loading.dismiss();\r\n      self.alertService.presentToast(this.translate.instant('MY_ACCOUNT.message_update_fail'));\r\n    });\r\n  }\r\n\r\n  updateAvatar() {\r\n    var self = this;\r\n    const params = {\r\n      avatar: self.avatar\r\n    };\r\n    this.apiService.postUpdateAvatar(params)\r\n      .subscribe(result => {\r\n        self.loading.dismiss();\r\n        self.alertService.presentToast(this.translate.instant('MY_ACCOUNT.message_update_sucess'));\r\n    },\r\n    error => {\r\n      self.loading.dismiss();\r\n      self.alertService.presentToast(this.translate.instant('MY_ACCOUNT.message_update_fail'));\r\n    });\r\n  }\r\n\r\n  onChangeCountry() {\r\n    this.listCountry.forEach(country => {\r\n      if (country.alpha2 == this.countryAlpha2) {\r\n        this.formPhoneCode = country.phoneCode;\r\n        this.avatarCountry = \"https://lipis.github.io/flag-icon-css/flags/4x3/\"+country.alpha2.toLowerCase()+\".svg\";\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n   // select image\r\n   async selectImage() {\r\n    const actionSheet = await this.actionSheetController.create({\r\n      header: this.translate.instant('COMMON.form_select_image_title'),\r\n      buttons: [{\r\n        text: this.translate.instant('COMMON.form_select_image_library'),\r\n        handler: () => {\r\n          this.checkPicturePermission(this.camera.PictureSourceType.PHOTOLIBRARY);\r\n        }\r\n      },\r\n      {\r\n        text: this.translate.instant('COMMON.form_select_image_camera'),\r\n        handler: () => {\r\n          this.checkPicturePermission(this.camera.PictureSourceType.CAMERA);\r\n        }\r\n      },\r\n      {\r\n        text: this.translate.instant('COMMON.form_select_image_cancel'),\r\n        role: 'cancel'\r\n      }\r\n      ]\r\n    });\r\n    await actionSheet.present();\r\n  }\r\n\r\n  checkPicturePermission(sourceType : PictureSourceType) {\r\n    this.pickImage(sourceType);\r\n  }\r\n\r\n  pickImage(sourceType) {\r\n    var self = this;\r\n    const options: CameraOptions = {\r\n      quality: 80,\r\n      sourceType: sourceType,\r\n      destinationType: this.camera.DestinationType.DATA_URL,\r\n      encodingType: this.camera.EncodingType.PNG,\r\n      mediaType: this.camera.MediaType.PICTURE,\r\n      targetWidth: 800,\r\n      targetHeight: 800,\r\n    }\r\n    \r\n    this.camera.getPicture(options).then((imageData) => {\r\n      const base64 = 'data:image/png;base64,';\r\n      const date = new Date().valueOf();\r\n      const imageName = date+ '.png';\r\n      var binaryBlob = this.convertBase64ToBlob(base64+imageData)\r\n      //var binaryBlob = atob(imageData);\r\n      //const imageFile = new File([binaryBlob], imageName, { type: 'image/png' });\r\n      const payload = new FormData();\r\n      payload.append('media', binaryBlob, imageName);\r\n      \r\n      this.apiService.uploadImage(payload)\r\n      .subscribe(result => {\r\n        if (result) {\r\n          self.isChangeAvatar = true;\r\n          self.avatar = result.media.url\r\n        }\r\n      },\r\n        error => {\r\n      });\r\n    }, (err) => {\r\n      // Handle error\r\n      // alert(err);\r\n    });\r\n  }\r\n\r\n  private convertBase64ToBlob(base64: string) {\r\n    const info = this.getInfoFromBase64(base64);\r\n    const sliceSize = 512;\r\n    const byteCharacters = window.atob(info.rawBase64);\r\n    const byteArrays = [];\r\n\r\n    for (let offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n      const slice = byteCharacters.slice(offset, offset + sliceSize);\r\n      const byteNumbers = new Array(slice.length);\r\n\r\n      for (let i = 0; i < slice.length; i++) {\r\n        byteNumbers[i] = slice.charCodeAt(i);\r\n      }\r\n\r\n      byteArrays.push(new Uint8Array(byteNumbers));\r\n    }\r\n\r\n    return new Blob(byteArrays, { type: info.mime });\r\n  }\r\n\r\n  private getInfoFromBase64(base64: string) {\r\n    const meta = base64.split(',')[0];\r\n    const rawBase64 = base64.split(',')[1].replace(/\\s/g, '');\r\n    const mime = /:([^;]+);/.exec(meta)[1];\r\n    const extension = /\\/([^;]+);/.exec(meta)[1];\r\n\r\n    return {\r\n      mime,\r\n      extension,\r\n      meta,\r\n      rawBase64\r\n    };\r\n  }\r\n}\r\n"]}